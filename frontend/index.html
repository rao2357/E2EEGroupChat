<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Chat Room</title>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/node-forge@1.0.0/dist/forge.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container-fluid vh-100 p-0">
        <div id="chat-container"
            class="d-flex flex-column h-100 border rounded shadow-sm bg-white overflow-hidden position-relative">
            <div id="top-bar" class="d-flex justify-content-between p-2 bg-light border-bottom">
                <div id="channel-info"><span id="current-channel-id"></span></div>
                <div id="status-message">正在连接...</div>
                <button id="toggle-users-list" class="btn btn-primary btn-sm" data-toggle="modal"
                    data-target="#usersModal">在线用户</button>
                <button id="set-nickname-button" class="btn btn-secondary btn-sm" data-toggle="modal"
                    data-target="#nicknameModal">设置昵称</button>
            </div>
            <div id="chat-box" class="flex-grow-1 p-2 overflow-auto"></div>
            <div id="input-container" class="border-top p-2 bg-light">
                <textarea id="input-message" class="form-control" placeholder="Enter message..." disabled></textarea>
                <button id="upload-image-button" class="btn btn-secondary btn-sm">上传图片</button>
                <button id="send-message-button" class="btn btn-primary btn-sm">发送</button>
                <input type="file" id="image-input" style="display: none;" accept="image/*">
                <div id="image-preview" style="margin-top: 10px;"></div>
            </div>
        </div>
    </div>

    <!-- Users Modal -->
    <div class="modal fade" id="usersModal" tabindex="-1" aria-labelledby="usersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="usersModalLabel">在线用户</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="users-list"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Nickname Modal -->
    <div class="modal fade" id="nicknameModal" tabindex="-1" aria-labelledby="nicknameModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nicknameModalLabel">设置昵称</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <input type="text" id="nickname-input" class="form-control" placeholder="输入你的昵称">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" id="save-nickname-button">保存</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="chat.js"></script>
</body>

</html>